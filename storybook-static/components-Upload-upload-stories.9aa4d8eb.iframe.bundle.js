"use strict";(self.webpackChunkvanilla_react_dkbrownn=self.webpackChunkvanilla_react_dkbrownn||[]).push([[727],{"./src/components/Upload/upload.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultType:()=>DefaultType,DragType:()=>DragType,__namedExportsOrder:()=>__namedExportsOrder,default:()=>upload_stories});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/@storybook/addon-actions/dist/index.mjs"),axios=__webpack_require__("./node_modules/axios/lib/axios.js"),Button_button=__webpack_require__("./src/components/Button/button.tsx"),icon=__webpack_require__("./src/components/Icon/icon.tsx"),progress=__webpack_require__("./src/components/Progress/progress.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const UploadList=_ref=>{let{fileList,onRemove}=_ref;return(0,jsx_runtime.jsx)("ul",{style:{padding:"0"},children:fileList.map((item=>(0,jsx_runtime.jsxs)("li",{className:"vanilla-upload-list-item",children:[(0,jsx_runtime.jsxs)("span",{className:`file-name file-name-${item.status}`,children:[(0,jsx_runtime.jsx)(icon.I,{style:{padding:"0 1rem"},icon:"file-alt",theme:"secondary"}),(0,jsx_runtime.jsx)("span",{children:item.name})]}),(0,jsx_runtime.jsxs)("span",{className:"file-status",children:["uploading"===item.status&&(0,jsx_runtime.jsx)(icon.I,{theme:"primary",icon:"spinner",spin:!0}),"success"===item.status&&(0,jsx_runtime.jsx)(icon.I,{theme:"success",icon:"check-circle"}),"error"===item.status&&(0,jsx_runtime.jsx)(icon.I,{theme:"danger",icon:"times-circle"})]}),(0,jsx_runtime.jsx)("span",{className:"file-actions",children:(0,jsx_runtime.jsx)(icon.I,{icon:"times",onClick:()=>onRemove(item)})}),"uploading"===item.status&&(0,jsx_runtime.jsx)(progress.k,{percent:item.percent||0})]},item.uid)))})};UploadList.__docgenInfo={description:"",methods:[],displayName:"UploadList",props:{fileList:{required:!0,tsType:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},description:"上传文件数组"},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(_file: UploadFile) => void",signature:{arguments:[{type:{name:"UploadFile"},name:"_file"}],return:{name:"void"}}},description:"删除"}}};var classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);const Dragger=_ref=>{let{onFile,children,...restProps}=_ref;const[dragger,setDragger]=(0,react.useState)(!1),classes=classnames_default()("vanilla-uploader-dragger",{"is-dragover":dragger}),handleDragger=(e,over)=>{e.preventDefault(),setDragger(over)};return(0,jsx_runtime.jsx)("div",{className:classes,onDragOver:e=>handleDragger(e,!0),onDragLeave:e=>handleDragger(e,!1),onDrop:e=>{e.preventDefault(),setDragger(!1),onFile(e.dataTransfer.files)},...restProps,children})};Dragger.__docgenInfo={description:"",methods:[],displayName:"Dragger",props:{onFile:{required:!0,tsType:{name:"signature",type:"function",raw:"(files: FileList) => void",signature:{arguments:[{type:{name:"FileList"},name:"files"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Upload=_ref=>{let{defultFileList,action,headers,name="file",data,withCredentials,accept,multiple,drag,beforeUpload,onError,onProgress,onSuccess,onChange,onRemove,children}=_ref;const fileRef=(0,react.useRef)(null),[fileList,setFileList]=(0,react.useState)(defultFileList||[]),handleClick=()=>{fileRef.current&&fileRef.current.click()},updateFileList=(updateFile,updateObj)=>{setFileList((prevList=>prevList.map((file=>file.uid===updateFile.uid?{...file,...updateObj}:file))))},uploadFiles=files=>{Array.from(files).forEach((file=>{if(beforeUpload){const result=beforeUpload(file);result&&result instanceof Promise?result.then((processFile=>{post(processFile)})):!1!==result&&post(file)}else post(file)}))},post=file=>{let _file={uid:Date.now().toString(),size:file.size,name:file.name,status:"ready",percent:0,raw:file};setFileList((prvList=>[_file,...prvList]));const formData=new FormData;formData.append(name||"file",file),data&&Object.keys(data).forEach((key=>{formData.append(key,data[key])})),axios.A.post(action,formData,{headers:{"Content-Type":"multipart/form-data",...headers},withCredentials,onUploadProgress:e=>{if(console.log(`total: ${e.total}, loaded: ${e.loaded}`),e.total){let percentage=Math.round(100*e.loaded/e.total)||0;console.log(percentage),percentage<100&&(updateFileList(_file,{percent:percentage,status:"uploading"}),onProgress&&onProgress(percentage,file))}}}).then((res=>{console.log(res),updateFileList(_file,{status:"success",response:res.data}),onSuccess&&onSuccess(res.data,file),onChange&&onChange(file)})).catch((err=>{updateFileList(_file,{status:"error",error:err}),onError&&onError(err,file),onChange&&onChange(file)}))};return console.log(fileList),(0,jsx_runtime.jsxs)("div",{className:"vanilla-upload-component",children:[drag?(0,jsx_runtime.jsx)(Dragger,{onClick:handleClick,onFile:files=>uploadFiles(files),children}):(0,jsx_runtime.jsx)(Button_button.$,{btnType:"primary",onClick:handleClick,children}),(0,jsx_runtime.jsx)("input",{className:"vanilla-file-input",style:{display:"none"},ref:fileRef,type:"file",onChange:e=>{const files=e.target.files;files&&(uploadFiles(files),fileRef.current&&(fileRef.current.value=""))},accept,multiple,"data-testid":"test-input"}),(0,jsx_runtime.jsx)(UploadList,{onRemove:file=>{setFileList((revList=>revList.filter((item=>item.uid!==file.uid)))),onRemove&&onRemove(file)},fileList,"data-testid":"test-list"})]})};Upload.__docgenInfo={description:'通过点击或者拖拽上传文件\r\n##引用方法\r\n~~~js\r\nimport { Upload } from "vanilla-react-dkbrownn"\r\n~~~',methods:[],displayName:"Upload",props:{defultFileList:{required:!1,tsType:{name:"Array",elements:[{name:"UploadFile"}],raw:"UploadFile[]"},description:"默认显示文件"},action:{required:!0,tsType:{name:"string"},description:"发送地址链接"},beforeUpload:{required:!1,tsType:{name:"signature",type:"function",raw:"(file: File) => boolean | Promise<File>",signature:{arguments:[{type:{name:"File"},name:"file"}],return:{name:"union",raw:"boolean | Promise<File>",elements:[{name:"boolean"},{name:"Promise",elements:[{name:"File"}],raw:"Promise<File>"}]}}},description:"上传文件前"},onProgress:{required:!1,tsType:{name:"signature",type:"function",raw:"(percentage: number, file: File) => void",signature:{arguments:[{type:{name:"number"},name:"percentage"},{type:{name:"File"},name:"file"}],return:{name:"void"}}},description:"进度"},onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(data: any, file: File) => void",signature:{arguments:[{type:{name:"any"},name:"data"},{type:{name:"File"},name:"file"}],return:{name:"void"}}},description:"成功"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(err: any, file: File) => void",signature:{arguments:[{type:{name:"any"},name:"err"},{type:{name:"File"},name:"file"}],return:{name:"void"}}},description:"失败"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(file: File) => void",signature:{arguments:[{type:{name:"File"},name:"file"}],return:{name:"void"}}},description:"上传成功后change事件"},onRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(file: UploadFile) => void",signature:{arguments:[{type:{name:"UploadFile"},name:"file"}],return:{name:"void"}}},description:"删除时触发的函数"},headers:{required:!1,tsType:{name:"signature",type:"object",raw:"{ [key: string]: any }",signature:{properties:[{key:{name:"string"},value:{name:"any",required:!0}}]}},description:"设置上传的请求头部"},name:{required:!1,tsType:{name:"string"},description:"上传的文件字段名",defaultValue:{value:'"file"',computed:!1}},data:{required:!1,tsType:{name:"signature",type:"object",raw:"{ [key: string]: any }",signature:{properties:[{key:{name:"string"},value:{name:"any",required:!0}}]}},description:"上传时附带的额外参数"},withCredentials:{required:!1,tsType:{name:"boolean"},description:"支持发送 cookie 凭证信息"},accept:{required:!1,tsType:{name:"string"},description:"可选参数, 接受上传的文件类型"},multiple:{required:!1,tsType:{name:"boolean"},description:"是否支持多选文件"},drag:{required:!1,tsType:{name:"boolean"},description:"是否支持拖拽上传"},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const defaultFileList=[{uid:"123",size:123,name:"h.md",status:"uploading",percent:30},{uid:"1235",size:1235,name:"hy.md",status:"error"},{uid:"1239",size:1239,name:"hyx.md",status:"success"}],upload_stories={title:"Upload组件",component:Upload},DefaultType=()=>(0,jsx_runtime.jsx)(Upload,{defultFileList:defaultFileList,action:"/api/posts",onChange:(0,dist.XI)("change"),onRemove:(0,dist.XI)("remove"),name:"fileName",data:{key:"value"},headers:{"X-Powered-By":"vanilla"},multiple:!0,children:"Upload file"});DefaultType.storyName="默认的Upload";const DragType=()=>(0,jsx_runtime.jsxs)(Upload,{defultFileList:defaultFileList,action:"/api/posts",onChange:(0,dist.XI)("change"),onRemove:(0,dist.XI)("remove"),name:"fileName",data:{key:"value"},headers:{"X-Powered-By":"vanilla"},multiple:!0,drag:!0,children:[(0,jsx_runtime.jsx)(icon.I,{icon:"upload",size:"5x",theme:"secondary"}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("p",{children:"点击或者拖动到此区域进行上传"})]});DragType.storyName="支持拖拽的Upload";const __namedExportsOrder=["DefaultType","DragType"];DefaultType.parameters={...DefaultType.parameters,docs:{...DefaultType.parameters?.docs,source:{originalSource:'() => <Upload defultFileList={defaultFileList} action={actionURL}\n// beforeUpload={filePromise}\n// onProgress={action("progress")}\n// onError={action("error")}\n// onSuccess={action("success")}\nonChange={action("change")} onRemove={action("remove")} name="fileName" data={{\n  "key": "value"\n}} headers={{\n  "X-Powered-By": "vanilla"\n}} multiple>\r\n    Upload file\r\n  </Upload>',...DefaultType.parameters?.docs?.source}}},DragType.parameters={...DragType.parameters,docs:{...DragType.parameters?.docs,source:{originalSource:'() => <Upload defultFileList={defaultFileList} action={actionURL}\n// beforeUpload={filePromise}\n// onProgress={action("progress")}\n// onError={action("error")}\n// onSuccess={action("success")}\nonChange={action("change")} onRemove={action("remove")} name="fileName" data={{\n  "key": "value"\n}} headers={{\n  "X-Powered-By": "vanilla"\n}} multiple drag>\r\n   <Icon icon="upload" size="5x" theme="secondary" />\r\n    <br />\r\n    <p>点击或者拖动到此区域进行上传</p>\r\n  </Upload>',...DragType.parameters?.docs?.source}}}},"./src/components/Button/button.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>Button});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Button=_ref=>{let{btnType="default",disabled=!1,size,children,href,className,...restProps}=_ref;const classes=classnames__WEBPACK_IMPORTED_MODULE_1___default()("vanilla-btn",className,{[`vanilla-btn-${btnType}`]:btnType,[`vanilla-btn-${size}`]:size,disabled:"link"===btnType&&disabled});return"link"===btnType&&href?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("a",{className:classes,href,...restProps,children}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("button",{className:classes,disabled,...restProps,children})};Button.__docgenInfo={description:'页面中最常用的的按钮元素，适合于完成特定的交互，支持 HTML button 和 a 链接 的所有属性\r\n##引用方法\r\n~~~js\r\nimport { Button } from "vanilla-react-dkbrownn"\r\n~~~',methods:[],displayName:"Button",props:{className:{required:!1,tsType:{name:"string"},description:"可以扩展的类名"},disabled:{required:!1,tsType:{name:"boolean"},description:"是否禁用",defaultValue:{value:"false",computed:!1}},size:{required:!1,tsType:{name:"union",raw:"'lg' | 'sm'",elements:[{name:"literal",value:"'lg'"},{name:"literal",value:"'sm'"}]},description:"Button 的尺寸"},btnType:{required:!1,tsType:{name:"union",raw:"'primary' | 'default' | 'danger' | 'link'",elements:[{name:"literal",value:"'primary'"},{name:"literal",value:"'default'"},{name:"literal",value:"'danger'"},{name:"literal",value:"'link'"}]},description:"按钮类型，共有四种分别为 'primary' | 'default' | 'danger' | 'link'",defaultValue:{value:'"default"',computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},href:{required:!1,tsType:{name:"string"},description:"当按钮类型为link时，跳转的链接"}},composes:["BaseButtonProps"]}},"./src/components/Icon/icon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>Icon});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@fortawesome/react-fontawesome/index.es.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Icon=_ref=>{let{theme,className,...restProps}=_ref;const classes=classnames__WEBPACK_IMPORTED_MODULE_1___default()("vanilla-icon",className,{[`vanilla-icon-${theme}`]:theme});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_2__.g,{className:classes,...restProps})};Icon.__docgenInfo={description:'提供了一套常用的图标集合 基y于react-fontawesome。\r\n\r\n支持 react-fontawesome的所有属性 可以在这里查询 https://github.com/FortAwesome/react-fontawesome#basic\r\n\r\n支持 fontawesome 所有 free-solid-icons，可以在这里查看所有图标 https://fontawesome.com/icons?d=gallery&s=solid&m=free\r\n\r\n##引用方法\r\n~~~js\r\nimport { Icon } from "vanilla-react-dkbrownn"\r\n~~~',methods:[],displayName:"Icon",props:{theme:{required:!1,tsType:{name:"union",raw:"'primary' | 'secondary' | 'success' | 'info' | 'warning' | 'danger' | 'light' | 'dark'",elements:[{name:"literal",value:"'primary'"},{name:"literal",value:"'secondary'"},{name:"literal",value:"'success'"},{name:"literal",value:"'info'"},{name:"literal",value:"'warning'"},{name:"literal",value:"'danger'"},{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"图标主题色"},size:{required:!1,tsType:{name:"SizeProp"},description:"图标尺寸"},icon:{required:!0,tsType:{name:"IconProp"},description:"图标类型"}},composes:["FontAwesomeIconProps"]}},"./src/components/Progress/progress.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>Progress});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Progress=_ref=>{let{touch=!1,showText=!0,percent,strokeHeight=15,styles,theme="primary"}=_ref;console.log("progress---");const outerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),innerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{outerRef.current&&console.log(outerRef.current.clientWidth,outerRef.current.offsetLeft)}));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"vanilla-progress-bar",style:styles,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"vanilla-progress-bar-outer",style:{height:`${strokeHeight}px`},onMouseEnter:e=>console.log(e.clientX,"enter"),onMouseMove:e=>{if(touch&&outerRef.current){const outerWidth=outerRef.current.clientWidth,innerX=e.clientX-outerRef.current.offsetLeft,percent=Math.round(innerX/outerWidth*100);innerRef.current&&(innerRef.current.style.width=`${percent}%`)}},onMouseLeave:e=>console.log(e.clientX,"leave"),ref:outerRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{ref:innerRef,className:`vanilla-progress-bar-inner color-${theme}`,style:{width:`${percent}%`},children:showText&&!touch&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("span",{className:"inner-text",children:[percent,"%"]})})})})};Progress.__docgenInfo={description:"",methods:[],displayName:"Progress",props:{touch:{required:!1,tsType:{name:"boolean"},description:"是否可以手动改变进度条",defaultValue:{value:"false",computed:!1}},showText:{required:!1,tsType:{name:"boolean"},description:"是否显示具体进度",defaultValue:{value:"true",computed:!1}},percent:{required:!0,tsType:{name:"number"},description:"百分比"},strokeHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"15",computed:!1}},styles:{required:!1,tsType:{name:"CSSProperties"},description:"可以扩展样式"},theme:{required:!1,tsType:{name:"union",raw:"'primary' | 'secondary' | 'success' | 'info' | 'warning' | 'danger' | 'light' | 'dark'",elements:[{name:"literal",value:"'primary'"},{name:"literal",value:"'secondary'"},{name:"literal",value:"'success'"},{name:"literal",value:"'info'"},{name:"literal",value:"'warning'"},{name:"literal",value:"'danger'"},{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"主题色",defaultValue:{value:'"primary"',computed:!1}},mouseMove:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:"处理鼠标控制进度"}}}}}]);